!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.yayson=t():e.yayson=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(e,t){var n=!0,r=!1,i=void 0;try{for(var u,o=Array.from(e)[Symbol.iterator]();!(n=(u=o.next()).done);n=!0){var a=u.value;if(t(a))return a}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}};t.default={find:i,filter:function(e,t){var n=[],r=!0,i=!1,u=void 0;try{for(var o,a=Array.from(e)[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var l=o.value;t(l)&&n.push(l)}}catch(e){i=!0,u=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw u}}return n},values:function(e){return null==e&&(e={}),Object.values(e)},clone:function(e){return null==e&&(e={}),r({},e)},any:function(e,t){return null!=i(e,t)},isPromise:function(e){return e===Object(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(){r(this,e)}return i(e,null,[{key:"get",value:function(e,t){return t?e[t]:e}},{key:"id",value:function(e){var t=this.get(e,"id");return void 0===t?t:""+t}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.adapter;return{Store:u.default,Presenter:p({adapter:t}),Adapter:a.default}};var i=n(3),u=r(i),o=n(1),a=r(o),l=n(5),s=r(l),f=n(7),c=r(f),d=function(e){return"default"===e?a.default:s.default[e]||e||a.default},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,c.default)(d(e.adapter))}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=r(o),l=n(4),s=r(l),f=function(){function e(){i(this,e),this.reset()}return u(e,[{key:"reset",value:function(){this.records=[],this.relations={}}},{key:"toModel",value:function(e,t,n){var r=this,i=a.default.clone(e.attributes)||{};if(i.id=e.id,i.type=e.type,n[t]||(n[t]={}),n[t][e.id]||(n[t][e.id]=i),i.hasOwnProperty("meta")&&(i.attributes={meta:i.meta},delete i.meta),null!=e.meta&&(i.meta=e.meta),null!=e.links&&(i.links=e.links),null!=e.relationships)for(var u in e.relationships){var o=e.relationships[u],l=o.data,s=o.links,f=o.meta;if(i[u]=null,null!=l||null!=s){var c=function(e){var t=e.type,i=e.id;return r.find(t,i,n)};i[u]=l instanceof Array?l.map(c):null!=l?c(l):{};var d=i[u];null!=d&&(d._links=s||{},d._meta=f||{})}}return i}},{key:"findRecord",value:function(e,t){return a.default.find(this.records,function(n){return n.type===e&&n.id===t})}},{key:"findRecords",value:function(e){return a.default.filter(this.records,function(t){return t.type===e})}},{key:"find",value:function(e,t,n){null==n&&(n={});var r=this.findRecord(e,t);return null==r?null:(n[e]||(n[e]={}),n[e][t]||this.toModel(r,e,n))}},{key:"findAll",value:function(e,t){var n=this;null==t&&(t={});var r=this.findRecords(e);return null==r?[]:(r.forEach(function(r){return t[e]||(t[e]={}),n.toModel(r,e,t)}),a.default.values(t[e]))}},{key:"remove",value:function(e,t){var n=this,r=function(e){var t=n.records.indexOf(e);if(!(t<0))return n.records.splice(t,1)};return null!=t?r(this.findRecord(e,t)):this.findRecords(e).map(r)}},{key:"sync",value:function(e){var t=this,n=function(e){if(null==e)return null;var n=function(e){var n=e.type,r=e.id;t.remove(n,r);var i=new s.default(e);return t.records.push(i),i};return e instanceof Array?e.map(n):n(e)};n(e.included);var r=n(e.data);if(null==r)return null;var i={},u=null;return u=r instanceof Array?r.map(function(e){return t.toModel(e,e.type,i)}):this.toModel(r,r.type,i),e.hasOwnProperty("links")&&(u.links=e.links),e.hasOwnProperty("meta")&&(u.meta=e.meta),u}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t){var n=t.id,i=t.type,u=t.attributes,o=t.relationships,a=t.links,l=t.meta;r(this,e),this.id=n,this.type=i,this.attributes=u,this.relationships=o,this.links=a,this.meta=l};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={sequelize:i.default}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),o(t,null,[{key:"get",value:function(e,t){if(null!=e)return e.get(t)}}]),t}(l.default);t.default=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){if(null!=e)return null!=e.self||null!=e.related?e:{self:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){var t,n;return n=t=function(){function t(n){var i=this;r(this,t),this.adapter=e,this.id=function(e){return i.adapter.id(e)},null==n&&(n={}),this.scope=n}return u(t,null,[{key:"toJSON",value:function(){var e;return(e=new this).toJSON.apply(e,arguments)}},{key:"render",value:function(){var e;return(e=new this).render.apply(e,arguments)}}]),u(t,[{key:"selfLinks",value:function(){}},{key:"links",value:function(){}},{key:"relationships",value:function(){}},{key:"attributes",value:function(e){if(null==e)return null;var t=a.default.clone(this.adapter.get(e));delete t.id,delete t.type;var n=this.relationships();for(var r in n)delete t[r];return t}},{key:"includeRelationships",value:function(e,t){var n=this,r=this.relationships();return function(){var i=[];for(var u in r){var o=r[u]||function(){throw new Error("Presenter for "+u+" in "+n.constructor.type+" is not defined")}(),a=new o(e),l=n.adapter.get(t,u);null!=l?i.push(a.toJSON(l,{include:!0})):i.push(void 0)}return i}()}},{key:"buildRelationships",value:function(e){var t=this;if(null==e)return null;var n=this.relationships(),r=this.links(e)||{},u=null;for(var o in n){var a=this.adapter.get(e,o),l=n[o],s=function(e){return a={id:t.adapter.id(e),type:l.type}};u||(u={}),u[o]||(u[o]={}),a instanceof Array?(u[o].data=a.map(s),null!=r[o]&&(u[o].links=i(r[o]))):u[o]=function(e){var t={};return null!=e&&(t.data=s(e)),null!=r[o]?t.links=i(r[o]):null==e&&(t.data=null),t}(a)}return u}},{key:"buildSelfLink",value:function(e){return i(this.selfLinks(e))}},{key:"toJSON",value:function(e,t){var n=this;if(null==t&&(t={}),null!=t.meta&&(this.scope.meta=t.meta),this.scope.data||(this.scope.data=null),null==e)return this.scope;if(e instanceof Array){var r=e;this.scope.data||(this.scope.data=[]),r.forEach(function(e){return n.toJSON(e,t)})}else{var i=e,u=!0,o={id:this.id(i),type:this.constructor.type,attributes:this.attributes(i)};void 0===o.id&&delete o.id;var l=this.buildRelationships(i);null!=l&&(o.relationships=l);var s=this.buildSelfLink(i);null!=s&&(o.links=s),t.include?(this.scope.included||(this.scope.included=[]),a.default.any(this.scope.included.concat(this.scope.data),function(e){return e.id===o.id&&e.type===o.type})?u=!1:this.scope.included.push(o)):null!=this.scope.data?this.scope.data instanceof Array&&a.default.any(this.scope.data,function(e){return e.id===o.id})?u=!1:this.scope.data.push(o):this.scope.data=o,u&&this.includeRelationships(this.scope,i)}return this.scope}},{key:"render",value:function(e,t){var n=this;return a.default.isPromise(e)?e.then(function(e){return n.toJSON(e,t)}):this.toJSON(e,t)}}]),t}(),t.type="objects",n};var o=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(o)}])});